# Raspberry Pi

This specific guide is not about setting up your Raspberry Pi to be a complete smart hub. Information on that can be found throughout this repo in relevant articles. *This guide is about how to set up your Raspberry Pi to be a working computer in the first place, outlining the early stages and choices that I made in setting up my Pi to be a future smart hub.*

For the purposes of this guide and flexibility, I just recommend installing Raspberry Pi OS (Raspbian). This will give you a full Debian-like Linux environment to do basically whatever you want with. There are other options, such as [Home Assistant OS](https://www.home-assistant.io/installation/raspberrypi) and [Homebridge](https://github.com/homebridge/homebridge-raspbian-image/wiki/Getting-Started), that you can flash easily to a Pi, but I avoided these as they limit the flexibility of using the device. In order to install these services anyways, one can use Docker on top of the OS and see similar results (see Docker article/other articles as they are written for information on using Docker to install and manage these services).

However, it is also worth noting that Home Assistant will have the best experience if you flash it directly to the Pi via Home Assistant OS. But it is still a great experience through the Docker container. I want to do a lot of stuff for my home with this single Pi 5, so I am sticking with the pure Linux tap.

## Get The Pi 5...

For the purposes of this smart home project, I chose a Raspberry Pi 5. These are shockingly capable computers for smart hub applications. With my Pi 5 with 4GB of RAM, I am able to record two 1080p streams 24/7, do object detection on those streams, run multiple smart home integration softwares, and more, without even really maxing out the resources it has to offer. I could probably do at least a few more cameras before it starts to really struggle.

It being an ARM computer, it is very efficient and low on power consumption. It also runs Linux very easily and is well supported by open-source software in the home hacking space. Perhaps, it would be an interesting project to do something similar like this with an M4 Mac Mini, but those are a lot more expensive (for astronomically more power, though). If you set reasonable expectations for your Pi 5 smart hub it can actually do quite a bit though. But for instance, ain't no way you're doing the NVR plus the smart home software plus any kind of media server without it getting at least a little shaky.

Especially nowadays, since the supply chain has gotten much stronger, I don't recommend getting anything less powerful than the Pi 5 with 4 GB if you are thinking of using it for similar jobs to me. I have heard some people have a decent experience with the Pi 4 with the same amount of RAM running 2-3 1080p cameras and the works, but there's no doubt the Pi 5 is a much more capable computer. 

The Pi 5 also has support for more M.2/PCIe cards such as the Coral TPU M.2 AI Accelerator, which is cheaper than the USB variant. So if you plan on using a TPU with the computer (say, for better object detection on your cameras that doesn't need to hit the CPU as hard), it is sort of a no-brainer. It will save you money on the TPU long term to get a Pi 5, just so you aren't stuck buying the USB one which is double the cost of the M.2 card.

## Raspberry Pi Imager

Regardless of which OS you choose to flash, it is easiest to flash and set up a Raspberry Pi with the [Raspberry Pi Imager](https://www.raspberrypi.org/software/) software. There is a pretty good [official step-by-step guide](https://www.raspberrypi.com/documentation/computers/getting-started.html#raspberry-pi-imager) to using the Imager software located in the [Raspberry Pi Documentation](https://www.raspberrypi.com/documentation/). As stated above, I installed [**Raspberry Pi OS**](https://www.raspberrypi.com/software/) onto my Raspberry Pi, which is essentially a Debian Linux port.

For the purposes of this guide, I will not go into extreme depth, but the important things are as follows:

1. Make sure you have a large enough MicroSD to be comfortable. I chose a 128 GB MicroSD. For most purposes, this should be fine. You should not be recording video onto the system drive anyways. Save the money and buy a fat external hard drive that can be separately powered with an additional adapter if you want to record video.
2. Be sure to set up a user account and enable SSH under services. You should use an RSA key or some kind of public-key authorization for SSH. **It is strongly advised by me and all other security conscious people not to use password authentication for SSH.** If you do not already have a private-public key pair, you can use the "Run SSH-Keygen" button. The important thing is that you have the corresponding private key in the clients' SSH agent, which should happen automatically using the Imager tool. The public key will be stored on the Raspberry Pi allowing any client which has the private key to securely log into the Pi's shell and operate it via commands. ![SSH settings in Raspberry Pi imager](https://www.raspberrypi.com/documentation/computers/images/imager/os-customisation-services.png?hash=bbc8c0ff2f1eb7207d43180d7694c399)
3. Set a memorable hostname (you will use this to connect, as well as whatever local IP your router assigns to it), and refrain from giving it access to your wireless network. You should probably use Ethernet when making a Raspberry Pi into a smart hub. If it is impossible to use Ethernet (it shouldn't be), then you can use wireless (there is nothing inherently unusable about it per se), but keep in mind smart home operation may/will be a lot less stable (and have more latency).

Once you have configured the OS and the related settings, all you need to do is go ahead and click through, flash the firmware to the MicroSD card, and eject it when done then pop it into the Raspberry Pi.

## Accessories/Hardware

While you can use just the bare Raspberry Pi computer, it can help to buy a few accessories to help its functionality. Of course, you need the aforementioned MicroSD card. But in my case, I also bought a little kit from Vilros that included acrylic top and bottom plates, mounting gear, and the official Raspberry Pi Active Cooler, which mounts directly onto the Raspberry Pi 5 toollessly and is software controlled via a little fan header on the board. I strongly recommend an active cooling solution/case of some kind, especially if you are using cameras/doing anything that will require high spikes of usage. The Active Cooler I bought rarely has to even engage because the system usually can subsist at low temperatures with simple passive cooling, due to the decently sized heatsink on the cooler. So, it operates with very sparse and quiet sound.

I also purchased an external power brick from Argon that uses GaN for ~$12, which should be an efficient and proper spec power supply for the Pi 5. As far as I understand, any USB-C PD charger that can give the proper wattage/amperage (>27W, 5A) should be fine, but your mileage may vary and in the end I just opted to buy a specific power supply for the Pi to be safe. There is also a stock Raspberry Pi one that you can buy separately, but I opted for the GaN one for the increased efficiency (and relatively low upcharge).

There are many so-called "hats" for Raspberry Pi 5 that can extend the functionality of the board and provide you with more I/O and features. These hats can give you M.2 drive capability, allow you to add a Coral TPU (for AI acceleration), an audio DAC, etc. With the basic Vilros test-bench style open "plate-case" you can pretty much mount all the hats and still put the plates back on, but it might be best for you to buy a case that includes some of the I/O / hat functionality you want built-in for a slicker integration. Argon sells some great cases with M.2 slots and beefy active cooling / better I/O built in, but they come at a somewhat significant premium over other solutions and you trade your flexibility for ease of integration.

## Setting up Raspberry Pi OS (Raspbian)
> To be continued...